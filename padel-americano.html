<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Padel Americano</title>
  <style>
    :root {
      --bg:         #0a1628;
      --surface:    #132238;
      --surface2:   #1a2e45;
      --border:     #243d5c;
      --text:       #e2e8f0;
      --muted:      #64748b;
      --accent:     #22c55e;
      --accent-dim: rgba(34,197,94,.12);
      --gold:       #fbbf24;
      --silver:     #9ca3af;
      --bronze:     #cd7f32;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 28px 16px 48px;
    }

    /* â”€â”€â”€ Screens â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .screen { display: none; max-width: 560px; margin: 0 auto; }
    .screen.active { display: block; animation: up .25s ease; }
    @keyframes up {
      from { opacity:0; transform:translateY(10px) }
      to   { opacity:1; transform:translateY(0)     }
    }

    /* â”€â”€â”€ Typography â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .app-title {
      text-align: center;
      font-size: 1.8rem;
      font-weight: 800;
      color: var(--accent);
      letter-spacing: -.02em;
      margin-bottom: 4px;
    }
    .app-sub {
      text-align: center;
      color: var(--muted);
      font-size: .875rem;
      margin-bottom: 32px;
    }

    /* â”€â”€â”€ Inputs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .players-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 28px;
    }
    .inp-group { display: flex; flex-direction: column; gap: 5px; }
    .inp-label {
      font-size: .68rem;
      font-weight: 700;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: .06em;
    }
    .txt-inp {
      background: var(--surface);
      border: 1.5px solid var(--border);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 8px;
      font-size: .95rem;
      width: 100%;
      transition: border-color .18s, box-shadow .18s;
    }
    .txt-inp::placeholder { color: var(--muted); }
    .txt-inp:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-dim);
    }

    /* â”€â”€â”€ Buttons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .btn {
      display: block; width: 100%;
      padding: 15px 24px;
      border: none; border-radius: 10px;
      font-size: 1rem; font-weight: 700;
      cursor: pointer;
      transition: transform .1s, filter .15s;
    }
    .btn:hover  { filter: brightness(1.06); }
    .btn:active { transform: scale(.98); }
    .btn-primary  { background: var(--accent); color: #0a1628; }
    .btn-outline  { background: transparent; color: var(--text);
                    border: 1.5px solid var(--border); margin-top: 10px; }

    /* â”€â”€â”€ Round header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .round-header { text-align: center; margin-bottom: 22px; }
    .round-lbl {
      font-size: .72rem; font-weight: 700; letter-spacing: .12em;
      text-transform: uppercase; color: var(--muted);
    }
    .round-num { font-size: 1.5rem; font-weight: 800; margin: 2px 0 10px; }

    .progress-track {
      width: 100%; height: 5px;
      background: var(--surface2); border-radius: 99px; overflow: hidden;
    }
    .progress-bar {
      height: 100%; background: var(--accent);
      border-radius: 99px; transition: width .4s ease;
    }

    /* â”€â”€â”€ Court card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .court-card {
      background: var(--surface);
      border: 1.5px solid var(--border);
      border-radius: 14px;
      padding: 18px 18px 16px;
      margin-bottom: 14px;
    }
    .court-badge {
      display: inline-block;
      font-size: .65rem; font-weight: 700;
      color: var(--accent); text-transform: uppercase; letter-spacing: .12em;
      background: var(--accent-dim);
      padding: 3px 9px; border-radius: 99px; margin-bottom: 12px;
    }

    /* Teams row */
    .teams-row {
      display: flex; align-items: center; gap: 8px; margin-bottom: 14px;
    }
    .team-lbl {
      flex: 1; font-size: .88rem; font-weight: 600;
      line-height: 1.35; word-break: break-word;
    }
    .team-lbl.right { text-align: right; }
    .vs-pill {
      font-size: .65rem; font-weight: 700; color: var(--muted);
      border: 1px solid var(--border); padding: 2px 6px; border-radius: 4px;
      flex-shrink: 0; white-space: nowrap;
    }

    /* Score inputs */
    .score-row { display: flex; align-items: flex-end; gap: 8px; }
    .score-box  { flex: 1; display: flex; flex-direction: column; gap: 4px; }
    .score-cap  { font-size: .65rem; color: var(--muted); text-align: center; }
    .score-inp {
      width: 100%;
      background: var(--bg);
      border: 1.5px solid var(--border);
      color: var(--text);
      padding: 12px 6px;
      border-radius: 8px;
      font-size: 1.5rem; font-weight: 700; text-align: center;
      -moz-appearance: textfield;
      transition: border-color .18s, box-shadow .18s;
    }
    .score-inp::-webkit-outer-spin-button,
    .score-inp::-webkit-inner-spin-button { -webkit-appearance: none; }
    .score-inp:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-dim);
    }
    .score-inp:disabled {
      color: var(--muted);
      border-color: var(--surface2);
      background: var(--surface);
      cursor: default;
    }
    .score-sep {
      font-size: 1.5rem; font-weight: 700; color: var(--muted);
      padding-bottom: 10px; /* align with input center */
      flex-shrink: 0;
    }

    /* Action area */
    .action-area { margin-top: 24px; }
    .inline-err {
      background: #450a0a; color: #fca5a5;
      border: 1px solid #7f1d1d; border-radius: 8px;
      padding: 10px 14px; font-size: .875rem; font-weight: 600;
      margin-bottom: 12px;
    }

    /* â”€â”€â”€ Leaderboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .results-top { text-align: center; margin-bottom: 26px; }
    .trophy { font-size: 3rem; margin-bottom: 6px; }

    .lb {
      background: var(--surface);
      border: 1.5px solid var(--border);
      border-radius: 14px; overflow: hidden;
      margin-bottom: 24px;
    }
    .lb-head {
      display: grid; grid-template-columns: 46px 1fr auto;
      padding: 10px 16px;
      background: var(--surface2);
      border-bottom: 1.5px solid var(--border);
    }
    .lb-head span {
      font-size: .65rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: .08em; color: var(--muted);
    }
    .lb-head span:last-child { text-align: right; }

    .lb-row {
      display: grid; grid-template-columns: 46px 1fr auto;
      align-items: center;
      padding: 13px 16px;
      border-bottom: 1px solid var(--border);
    }
    .lb-row:last-child { border-bottom: none; }
    .lb-row.r1 { background: rgba(251,191,36,.07); }
    .lb-row.r2 { background: rgba(156,163,175,.05); }
    .lb-row.r3 { background: rgba(205,127,50,.05); }

    .lb-rank { font-size: .95rem; font-weight: 700; color: var(--muted); }
    .lb-row.r1 .lb-rank { color: var(--gold); }
    .lb-row.r2 .lb-rank { color: var(--silver); }
    .lb-row.r3 .lb-rank { color: var(--bronze); }

    .lb-name { font-size: .95rem; font-weight: 600; }
    .lb-pts  { font-size: 1rem; font-weight: 700; color: var(--accent); }

    /* â”€â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 400px) {
      .players-grid { grid-template-columns: 1fr; }
      body { padding: 18px 12px 36px; }
      .team-lbl { font-size: .8rem; }
    }
  </style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCREEN 1 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="screen1" class="screen active">
  <h1 class="app-title">Padel Americano</h1>
  <p class="app-sub">Wpisz imiona 12 graczy</p>
  <div class="players-grid" id="playersGrid"></div>
  <button class="btn btn-primary" onclick="startTournament()">Losuj pary â†’</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCREEN 2 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="screen2" class="screen">
  <div class="round-header">
    <div class="round-lbl">Aktualna runda</div>
    <div class="round-num" id="roundNum">1 / 11</div>
    <div class="progress-track">
      <div class="progress-bar" id="progressBar" style="width:0%"></div>
    </div>
  </div>
  <div id="courts"></div>
  <div class="action-area" id="actionArea">
    <button class="btn btn-primary" id="actionBtn" onclick="advance()">NastÄ™pna runda â†’</button>
    <button class="btn btn-outline" onclick="finishEarly()">ZakoÅ„cz turniej wczeÅ›niej</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCREEN 3 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="screen3" class="screen">
  <div class="results-top">
    <div class="trophy">ğŸ†</div>
    <h1 class="app-title">Wyniki koÅ„cowe</h1>
    <p class="app-sub">Turniej zakoÅ„czony!</p>
  </div>
  <div class="lb" id="lb"></div>
  <button class="btn btn-primary" onclick="restart()">Zagraj ponownie</button>
</div>

<script>
/* â”€â”€â”€ Constants â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const ROUNDS       = 11;
const COURT_SCORE  = 21;
const N            = 12;

/* â”€â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let players = [];   // [{id, name}, â€¦]  (12 items, shuffled each start)
let pts     = {};   // { playerId: totalPoints }
let round   = 0;
let courts  = [];   // [{court, team1:[p,p], team2:[p,p]}, â€¦]

/* â”€â”€â”€ Utilities â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function shuffle(a) {
  const b = [...a];
  for (let i = b.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [b[i], b[j]] = [b[j], b[i]];
  }
  return b;
}

function showScreen(n) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen' + n).classList.add('active');
  window.scrollTo(0, 0);
}

/* â”€â”€â”€ Screen 1: Build inputs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function buildInputs() {
  const g = document.getElementById('playersGrid');
  g.innerHTML = '';
  for (let i = 0; i < N; i++) {
    const d = document.createElement('div');
    d.className = 'inp-group';
    d.innerHTML = `
      <span class="inp-label">Gracz ${i + 1}</span>
      <input class="txt-inp" id="p${i}" type="text"
             placeholder="ImiÄ™" autocomplete="off" spellcheck="false">
    `;
    g.appendChild(d);
  }
}

/* â”€â”€â”€ Start tournament â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function startTournament() {
  players = Array.from({ length: N }, (_, i) => {
    const v = document.getElementById('p' + i).value.trim();
    return { id: i, name: v || ('Gracz ' + (i + 1)) };
  });

  pts    = Object.fromEntries(players.map(p => [p.id, 0]));
  players = shuffle(players);   // random seed for round 1
  round  = 1;
  courts = makePairings();

  showScreen(2);
  renderRound();
}

/* â”€â”€â”€ Americano pairing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
/*
  Sort all 12 players by cumulative score (desc).
  Split into three groups of 4 (one per court).
  Within each group: team1 = [rank1, rank4], team2 = [rank2, rank3].
  This balances the match while keeping similar-level players together.
*/
function makePairings() {
  const ranked = [...players].sort((a, b) => pts[b.id] - pts[a.id]);
  return [0, 1, 2].map(i => {
    const g = ranked.slice(i * 4, i * 4 + 4);
    return { court: i + 1, team1: [g[0], g[3]], team2: [g[1], g[2]] };
  });
}

/* â”€â”€â”€ Render current round â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderRound() {
  document.getElementById('roundNum').textContent   = round + ' / ' + ROUNDS;
  document.getElementById('progressBar').style.width = ((round - 1) / ROUNDS * 100) + '%';
  document.getElementById('actionBtn').textContent  =
    round >= ROUNDS ? 'Podsumuj wyniki â†’' : 'NastÄ™pna runda â†’';

  // clear old error
  const old = document.querySelector('.inline-err');
  if (old) old.remove();

  const box = document.getElementById('courts');
  box.innerHTML = '';

  courts.forEach((c, idx) => {
    const n1 = c.team1.map(p => p.name).join(' & ');
    const n2 = c.team2.map(p => p.name).join(' & ');

    const card = document.createElement('div');
    card.className = 'court-card';
    card.innerHTML = `
      <span class="court-badge">Kort ${c.court}</span>
      <div class="teams-row">
        <div class="team-lbl">${n1}</div>
        <div class="vs-pill">VS</div>
        <div class="team-lbl right">${n2}</div>
      </div>
      <div class="score-row">
        <div class="score-box">
          <div class="score-cap">${n1}</div>
          <input class="score-inp" id="s${idx}" type="number"
                 inputmode="numeric" min="0" max="21"
                 placeholder="â€”"
                 onfocus="this.select()"
                 oninput="calcOpp(${idx})">
        </div>
        <div class="score-sep">:</div>
        <div class="score-box">
          <div class="score-cap">${n2}</div>
          <input class="score-inp" id="o${idx}" type="number"
                 placeholder="â€”" disabled>
        </div>
      </div>
    `;
    box.appendChild(card);
  });

  // auto-focus first score input
  setTimeout(() => {
    const first = document.getElementById('s0');
    if (first) first.focus();
  }, 50);
}

/* â”€â”€â”€ Live score calc â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function calcOpp(idx) {
  const inp = document.getElementById('s' + idx);
  const opp = document.getElementById('o' + idx);
  const raw = inp.value;

  if (raw === '') { opp.value = ''; return; }

  let v = parseInt(raw, 10);
  if (isNaN(v))  { inp.value = ''; opp.value = ''; return; }
  if (v < 0)       v = 0;
  if (v > COURT_SCORE) v = COURT_SCORE;

  inp.value = v;
  opp.value = COURT_SCORE - v;
}

/* â”€â”€â”€ Advance to next round or finish â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function advance() {
  // remove old error
  const old = document.querySelector('.inline-err');
  if (old) old.remove();

  // validate
  for (let i = 0; i < courts.length; i++) {
    if (document.getElementById('s' + i).value === '') {
      showErr('Wpisz wynik dla Kortu ' + (i + 1));
      return;
    }
  }

  // commit points
  courts.forEach((c, i) => {
    const s1 = parseInt(document.getElementById('s' + i).value, 10);
    const s2 = COURT_SCORE - s1;
    c.team1.forEach(p => { pts[p.id] += s1; });
    c.team2.forEach(p => { pts[p.id] += s2; });
  });

  if (round >= ROUNDS) {
    showScreen(3);
    renderResults();
  } else {
    round++;
    courts = makePairings();
    renderRound();
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
}

function showErr(msg) {
  const el = document.createElement('div');
  el.className = 'inline-err';
  el.textContent = 'âš  ' + msg;
  const area = document.getElementById('actionArea');
  area.insertBefore(el, area.firstChild);
  setTimeout(() => el.remove(), 3500);
}

/* â”€â”€â”€ Results â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderResults() {
  const sorted = [...players].sort((a, b) => pts[b.id] - pts[a.id]);
  const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
  const cls    = ['r1', 'r2', 'r3'];

  const lb = document.getElementById('lb');
  lb.innerHTML = `
    <div class="lb-head">
      <span>#</span><span>Gracz</span><span>Punkty</span>
    </div>
  `;

  sorted.forEach((p, i) => {
    const row = document.createElement('div');
    row.className = 'lb-row' + (i < 3 ? ' ' + cls[i] : '');
    row.innerHTML = `
      <div class="lb-rank">${medals[i] ?? (i + 1)}</div>
      <div class="lb-name">${p.name}</div>
      <div class="lb-pts">${pts[p.id]}</div>
    `;
    lb.appendChild(row);
  });
}

/* â”€â”€â”€ Finish early â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function finishEarly() {
  if (!confirm('Na pewno zakoÅ„czyÄ‡ turniej i pokazaÄ‡ wyniki?')) return;
  showScreen(3);
  renderResults();
}

/* â”€â”€â”€ Restart â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function restart() {
  players = []; pts = {}; round = 0; courts = [];
  buildInputs();
  showScreen(1);
}

/* â”€â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
buildInputs();
</script>
</body>
</html>
